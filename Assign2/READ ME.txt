The below code is written by aforementioned author independently and any reseblence to other code(s) is pure coincidence or 
the code might have been referred to this. The below code, as developed through various fixes, can be found on github.